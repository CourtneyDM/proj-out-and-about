<!DOCTYPE html>
<html>

<head>
    <style>
        #map {
            height: 400px;
            width: 100%;
        }
    </style>
</head>

<body>
    <h3>My Google Maps Demo</h3>
    <div id="map"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://api.eventful.com/js/api"></script>
    <script>
        
        function show_alert() {
            var lat = "";
            var long = "";
            
            var oArgs = {
                method: 'GET',
                url: "http://api.eventful.com/json/events/search",
                data :{
                app_key: "2DXR829kvdp9JrdB",

                location: "Dallas",
                category: "Coding",
                page_size: 5,
                sort_order: 'popularity',
                date: "Next Week"
                },
                dataType: 'jsonp',
                crossDomain: true

            };

            $.ajax(oArgs)
                .then(function(oData){
                    lat = parseFloat(oData.events.event[1].latitude);
                    long = parseFloat(oData.events.event[1].longitude)
                    console.log(oData);
                    let eventData = {
                        title: oData.events.event[1].title,
                        venue_name: oData.events.event[1].venue_name,
                        venue_address: oData.events.event[1].venue_address,
                        city_name: oData.events.event[1].city_name,

                    }
                    initMap(lat, long, eventData);
                })
            
            

        }
        show_alert();
    </script>
    <script>
        function initMap(lat, long, eventData) {
            var infoWindow = new google.maps.InfoWindow;
            var uluru = { lat: lat, lng: long };
            infoWindow.setPosition(uluru);
            
            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 15,
                center: uluru
            });
            var marker = new google.maps.Marker({
                position: uluru,
                map: map
            });
            marker.addListener('click',function(e){
                infoWindow.open(map);
                infoWindow.setContent(`
                    <div>
                        <h3>${eventData.title}</h3>
                        <h5>${eventData.venue_name}</h5>
                        <p>${eventData.venue_address}</p>
                        <p>${eventData.city_name}</p>

                    </div>

                `);
            });
        }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDPUWhQgbEHM3-FjpHcb4yqDBjZ2dwfMs0&callback=initMap">
    </script>

</body>

</html>